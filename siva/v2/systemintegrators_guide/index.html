<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>5.2 System integrator's guide - SiVa - Validation Service Documentation</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="SiVa - Validation Service Documentation">
    <meta property="og:image" content="None/../../../">
    <meta name="apple-mobile-web-app-title" content="SiVa - Validation Service Documentation">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../../None">
    <link rel="icon" type="image/x-icon" href="../../../None">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../../assets/fonts/icon.eot?52m981');
      	src: url('../../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../../assets/stylesheets/application-0dac3e5884.css">
    
      <link rel="stylesheet" href="../../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Roboto+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../../override.css">
    
    <script src="../../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-cyan palette-accent-light-blue">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                5. DEPLOYMENT <i class="icon icon-link"></i>
              
            
          </span>
        
        5.2 System integrator's guide
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/open-eid/SiVa" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          SiVa - Validation Service Documentation
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          open-eid/SiVa
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/open-eid/SiVa/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/open-eid/SiVa/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="VERSION HISTORY" href="../../version_info/">
      VERSION HISTORY
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="INTRODUCTION" href="../../..">
      INTRODUCTION
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="1. DEFINITIONS" href="../../definitions/">
      1. DEFINITIONS
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="2. BACKGROUND" href="../../overview/">
      2. BACKGROUND
    </a>
    
  </li>

          
            
  <li>
    <span class="section">3. STRUCTURE & ACTIVITIES</span>
    <ul>
      
        
  <li>
    <a class="" title="3.1 Component model" href="../structure_and_activities/">
      3.1 Component model
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="3.2 Use cases" href="../use_cases/">
      3.2 Use cases
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="4. INTERFACES" href="../interfaces/">
      4. INTERFACES
    </a>
    
  </li>

          
            
  <li>
    <span class="section">5. DEPLOYMENT</span>
    <ul>
      
        
  <li>
    <a class="" title="5.1 Deployment model" href="../deployment/">
      5.1 Deployment model
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="5.2 System integrator's guide" href="./">
      5.2 System integrator's guide
    </a>
    
      
      
        <ul>
          
            <li class="anchor">
              <a title="System requirements" href="#system-requirements">
                System requirements
              </a>
            </li>
          
            <li class="anchor">
              <a title="Building" href="#building">
                Building
              </a>
            </li>
          
            <li class="anchor">
              <a title="Deploying" href="#deploying">
                Deploying
              </a>
            </li>
          
            <li class="anchor">
              <a title="Logging" href="#logging">
                Logging
              </a>
            </li>
          
            <li class="anchor">
              <a title="Statistics" href="#statistics">
                Statistics
              </a>
            </li>
          
            <li class="anchor">
              <a title="Monitoring" href="#monitoring">
                Monitoring
              </a>
            </li>
          
            <li class="anchor">
              <a title="Configuration parameters" href="#configuration-parameters">
                Configuration parameters
              </a>
            </li>
          
            <li class="anchor">
              <a title="FAQ" href="#faq">
                FAQ
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">6. QUALITY ASSURANCE</span>
    <ul>
      
        
  <li>
    <a class="" title="6.1 QA Strategy" href="../../qa_strategy/">
      6.1 QA Strategy
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="6.2 Test Plan" href="../../test_plan/">
      6.2 Test Plan
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="7. REFERENCES" href="../../references/">
      7. REFERENCES
    </a>
    
  </li>

          
            
  <li>
    <span class="section">APPENDICES</span>
    <ul>
      
        
  <li>
    <a class="" title="Appendix 1 - Validation Policy" href="../../appendix/validation_policy/">
      Appendix 1 - Validation Policy
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Appendix 2 - Test Case Descriptions" href="../../appendix/test_cases/">
      Appendix 2 - Test Case Descriptions
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Appendix 3 - WSDL of SOAP Interface" href="../../appendix/wsdl/">
      Appendix 3 - WSDL of SOAP Interface
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Appendix 4 - Known Issues" href="../../appendix/known_issues/">
      Appendix 4 - Known Issues
    </a>
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
            <h1>5.2 System integrator's guide</h1>
          
          <p>This guide describes how to integrate SiVa service with other applications.
The following is for system integrators who need to set-up, configure, manage, and troubleshoot SiVa system.</p>
<h3 id="system-requirements">System requirements</h3>
<p>Following are the minimum requirements to build and deploy SiVa webapps as a service:</p>
<ul>
<li>Java 8 or above Oracle JVM is supported</li>
<li>Git version control system version 1.8 or above is recommended</li>
<li>Minimum 2 GB of RAM. Recommended at least 4 GB of RAM</li>
<li>Minimum 1 processor core</li>
<li>Open internet connection</li>
<li>1GB of free disk space</li>
<li>Supported operating system is Ubuntu 14.04 LTS</li>
</ul>
<h2 id="building">Building</h2>
<h3 id="building-siva-webapps-on-ubuntu-1604">Building SiVa webapps on Ubuntu 16.04</h3>
<p>First we need to install Git and Java SDK 8 by issuing below commands:</p>
<div class="codehilite"><pre><span></span>sudo apt-get update
sudo apt-get install git -y
sudo apt-get install default-jdk -y
</pre></div>


<p>Next we need to clone the SiVa Github repository:</p>
<div class="codehilite"><pre><span></span>git clone https://github.com/open-eid/SiVa.git --branch master
</pre></div>


<p>Final step is building the SiVa project using Maven Wrapper</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> SiVa
./mvnw clean install
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The build can take up to <strong>30 minutes</strong> because there are lot of tests that will be run through and downloading of the
required dependencies</p>
</div>
<p>To verify that SiVa project built successfully look for <code>BUILD SUCCESS</code> in build compilation output last lines.
The last lines of build output should look very similar to below image:</p>
<div class="codehilite"><pre><span></span>[INFO] Reactor Summary:
[INFO]
[INFO] SiVa Digitally signed documents validation service . SUCCESS [ 25.258 s]
[INFO] validation-services-parent ......................... SUCCESS [  0.479 s]
[INFO] validation-commons ................................. SUCCESS [01:45 min]
[INFO] tsl-loader ......................................... SUCCESS [ 16.507 s]
[INFO] PDF Validation Service ............................. SUCCESS [ 42.263 s]
[INFO] BDOC Validation Service ............................ SUCCESS [ 58.864 s]
[INFO] DDOC Validation Service ............................ SUCCESS [  9.929 s]
[INFO] xroad-validation-service ........................... SUCCESS [  5.664 s]
[INFO] SIVa webapp and other core modules ................. SUCCESS [  0.315 s]
[INFO] SiVa validation service proxy ...................... SUCCESS [ 43.098 s]
[INFO] siva-webapp ........................................ SUCCESS [04:06 min]
[INFO] SiVa Sample Web application ........................ SUCCESS [04:31 min]
[INFO] SiVa Web Service integration tests ................. SUCCESS [03:41 min]
[INFO] siva-distribution .................................. SUCCESS [ 56.941 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 18:30 min
[INFO] Finished at: 2016-07-22T13:40:31+00:00
[INFO] Final Memory: 80M/250M
[INFO] ------------------------------------------------------------------------
</pre></div>


<h2 id="deploying">Deploying</h2>
<h3 id="option-1-starting-webapps-from-command-line">OPTION 1 - starting webapps from command line</h3>
<p>SiVa project compiles <strong>3 fat executable JAR</strong> files that you can run after successfully building the
project by issuing below commands:</p>
<p><strong>First start the Siva webapp</strong></p>
<div class="codehilite"><pre><span></span>./siva-parent/siva-webapp/target/siva-webapp-2.0.2-SNAPSHOT.jar
</pre></div>


<p><strong>Second we need to start X-road validation webapp</strong></p>
<div class="codehilite"><pre><span></span>./validation-services-parent/xroad-validation-service/target/xroad-validation-service-2.0.2-SNAPSHOT.jar
</pre></div>


<p>The SiVa webapp by default runs on port <strong>8080</strong> and XRoad validation service starts up on port <strong>8081</strong>.
Easiest way to test out validation is run SiVa demo application.</p>
<p><strong>Start the Demo webapp</strong></p>
<div class="codehilite"><pre><span></span>./siva-parent/siva-sample-application/target/siva-sample-application-2.0.2-SNAPSHOT.jar
</pre></div>


<p>Now point Your browser to URL: <a href="http://localhost:9000">http://localhost:9000</a></p>
<h3 id="option-2-running-webapps-as-systemd-services">OPTION 2 - running webapps as systemd services</h3>
<p>Maven build generates executable JAR files. This means web container and all its dependencies are package inside
single JAR file. It makes a lot easier to deploy it into servers.</p>
<p>Easiest option to setup SiVa is as <code>systemd</code> service in Ubuntu servers.</p>
<p>For that we first need to create service file:</p>
<div class="codehilite"><pre><span></span>vim siva-webapp.service
</pre></div>


<p>Inside it we need to paste below text. You need to change few things in service setup file.</p>
<ul>
<li>First you <strong>must not</strong> run service as <code>root</code>. So it's strongly recommended to change line <code>User=root</code></li>
<li>Second You can change Java JVM options by modifying the <code>JAVA_OPTS</code> inside the <code>siva-webapp.service</code> file.</li>
<li>Also You can change the SiVa application configuration options by modifying <code>RUN_ARGS</code> section in file</li>
</ul>
<div class="codehilite"><pre><span></span><span class="k">[Unit]</span>
<span class="na">Description</span><span class="o">=</span><span class="s">siva-webapp</span>
<span class="na">After</span><span class="o">=</span><span class="s">syslog.target</span>

<span class="k">[Service]</span>
<span class="na">User</span><span class="o">=</span><span class="s">root</span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/var/apps/siva-webapp.jar</span>
<span class="na">Environment</span><span class="o">=</span><span class="s">JAVA_OPTS=-Xmx320m RUN_ARGS=--server.port=80</span>
<span class="na">SuccessExitStatus</span><span class="o">=</span><span class="s">143</span>

<span class="k">[Install]</span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span>
</pre></div>


<p>Save and close the <code>siva-webapp.service</code> file.
Next we need to move <code>siva-webapp-2.0.2-SNAPSHOT.jar</code> into newly created <code>/var/apps</code> directory and rename to
JAR file to <code>siva-webapp.jar</code>. match</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The copied JAR filename must match option <code>ExecStart</code> in  <code>siva-webapp.service</code> file</p>
</div>
<div class="codehilite"><pre><span></span>sudo mkdir /var/apps
sudo cp siva-parent/siva-webapp/target/executable/siva-webapp-2.0.2-SNAPSHOT.jar /var/apps/siva-webapp.jar
</pre></div>


<p>Next we need to copy the <code>siva-webapp.service</code> file into <code>/lib/systemd/system</code> directory.
Then we are ready to start the <code>siva-webapp</code> service.</p>
<div class="codehilite"><pre><span></span>sudo cp siva-webapp.service /lib/systemd/system
sudo systemctl start siva-webapp
</pre></div>


<p>Final step of setting up the <code>siva-webapp</code> service is to verify that service started correctly by issuing below
command.</p>
<div class="codehilite"><pre><span></span>systemctl status siva-webapp
</pre></div>


<p>It should print out similar to below picture:</p>
<div class="codehilite"><pre><span></span><span class="err">●</span> <span class="nt">siva-webapp</span><span class="nc">.service</span> <span class="nt">-</span> <span class="nt">siva-webapp</span>
   <span class="nt">Loaded</span><span class="o">:</span> <span class="nt">loaded</span> <span class="o">(/</span><span class="nt">lib</span><span class="o">/</span><span class="nt">systemd</span><span class="o">/</span><span class="nt">system</span><span class="o">/</span><span class="nt">siva-webapp</span><span class="nc">.service</span><span class="o">;</span> <span class="nt">disabled</span><span class="o">;</span> <span class="nt">vendor</span> <span class="nt">preset</span><span class="o">:</span> <span class="nt">enabled</span><span class="o">)</span>
   <span class="nt">Active</span><span class="o">:</span> <span class="nt">active</span> <span class="o">(</span><span class="nt">running</span><span class="o">)</span> <span class="nt">since</span> <span class="nt">Thu</span> <span class="nt">2016-07-21</span> <span class="nt">08</span><span class="nd">:48:14</span> <span class="nt">EDT</span><span class="o">;</span> <span class="nt">1</span> <span class="nt">day</span> <span class="nt">2h</span> <span class="nt">ago</span>
 <span class="nt">Main</span> <span class="nt">PID</span><span class="o">:</span> <span class="nt">15965</span> <span class="o">(</span><span class="nt">siva-webapp</span><span class="nc">.jar</span><span class="o">)</span>
    <span class="nt">Tasks</span><span class="o">:</span> <span class="nt">34</span>
   <span class="nt">Memory</span><span class="o">:</span> <span class="nt">429</span><span class="nc">.6M</span>
      <span class="nt">CPU</span><span class="o">:</span> <span class="nt">2min</span> <span class="nt">5</span><span class="nc">.721s</span>
   <span class="nt">CGroup</span><span class="o">:</span> <span class="o">/</span><span class="nt">system</span><span class="nc">.slice</span><span class="o">/</span><span class="nt">siva-webapp</span><span class="nc">.service</span>
           <span class="err">├─</span><span class="nt">15965</span> <span class="o">/</span><span class="nt">bin</span><span class="o">/</span><span class="nt">bash</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">apps</span><span class="o">/</span><span class="nt">stage</span><span class="o">/</span><span class="nt">siva-webapp</span><span class="nc">.jar</span>
           <span class="err">└─</span><span class="nt">15982</span> <span class="o">/</span><span class="nt">usr</span><span class="o">/</span><span class="nt">bin</span><span class="o">/</span><span class="nt">java</span> <span class="nt">-Dsun</span><span class="nc">.misc.URLClassPath.disableJarChecking</span><span class="o">=</span><span class="nt">true</span> <span class="nt">-Xmx320m</span> <span class="nt">-jar</span> <span class="o">/</span><span class="nt">var</span><span class="o">/</span><span class="nt">apps</span><span class="o">/</span><span class="nt">stage</span><span class="o">/</span><span class="nt">siva-webapp</span><span class="nc">.jar</span>

<span class="nt">Jul</span> <span class="nt">20</span> <span class="nt">03</span><span class="nd">:00:01</span> <span class="nt">siva</span> <span class="nt">siva-webapp</span><span class="nc">.jar</span><span class="cp">[</span><span class="mi">15965</span><span class="cp">]</span><span class="o">:</span>         <span class="nt">at</span> <span class="nt">eu</span><span class="nc">.europa.esig.dss.tsl.service.TSLParser.getTslModel</span><span class="o">(</span><span class="nt">TSLParser</span><span class="nc">.java</span><span class="nd">:143</span><span class="o">)</span>
<span class="nt">Jul</span> <span class="nt">20</span> <span class="nt">03</span><span class="nd">:00:01</span> <span class="nt">siva</span> <span class="nt">siva-webapp</span><span class="nc">.jar</span><span class="cp">[</span><span class="mi">15965</span><span class="cp">]</span><span class="o">:</span>         <span class="nt">at</span> <span class="nt">eu</span><span class="nc">.europa.esig.dss.tsl.service.TSLParser.call</span><span class="o">(</span><span class="nt">TSLParser</span><span class="nc">.java</span><span class="nd">:129</span><span class="o">)</span>
<span class="nt">Jul</span> <span class="nt">20</span> <span class="nt">03</span><span class="nd">:00:01</span> <span class="nt">siva</span> <span class="nt">siva-webapp</span><span class="nc">.jar</span><span class="cp">[</span><span class="mi">15965</span><span class="cp">]</span><span class="o">:</span>         <span class="o">...</span> <span class="nt">5</span> <span class="nt">common</span> <span class="nt">frames</span> <span class="nt">omitted</span>
<span class="nt">Jul</span> <span class="nt">20</span> <span class="nt">03</span><span class="nd">:00:01</span> <span class="nt">siva</span> <span class="nt">siva-webapp</span><span class="nc">.jar</span><span class="cp">[</span><span class="mi">15965</span><span class="cp">]</span><span class="o">:</span> <span class="nt">20</span><span class="nc">.07.2016</span> <span class="nt">03</span><span class="nd">:00:01</span><span class="nc">.450</span> <span class="nt">INFO</span>  <span class="cp">[</span><span class="nx">pool</span><span class="o">-</span><span class="mi">3</span><span class="na">-thread</span><span class="o">-</span><span class="mi">1</span><span class="cp">]</span> <span class="cp">[</span><span class="nx">e.e.e.dss.tsl.service.TSLRepository.sync</span>
<span class="nx">Jul</span> <span class="mi">20</span> <span class="mi">03</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="nx">siva</span> <span class="nx">siva</span><span class="na">-webapp.jar</span><span class="err">[</span><span class="mi">15965</span><span class="cp">]</span><span class="o">:</span> <span class="nt">20</span><span class="nc">.07.2016</span> <span class="nt">03</span><span class="nd">:00:01</span><span class="nc">.450</span> <span class="nt">INFO</span>  <span class="cp">[</span><span class="nx">pool</span><span class="o">-</span><span class="mi">3</span><span class="na">-thread</span><span class="o">-</span><span class="mi">1</span><span class="cp">]</span> <span class="cp">[</span><span class="nx">e.e.e.dss.tsl.service.TSLRepository.sync</span>
</pre></div>


<h3 id="option-3-deploy-webapps-as-war-files-tomcat-setup-for-legacy-systems">OPTION 3  - deploy webapps as war files (Tomcat setup for legacy systems)</h3>
<blockquote>
<p><strong>NOTE 1</strong>: We do not recommend using WAR deployment option because lack of testing done on different servlet
containers also possible container application libraries conflicts</p>
<p><strong>NOTE 2</strong>: Each SiVa service <strong>must</strong> be deployed to separate instance of Tomcat to avoid Java JAR library version
conflicts.</p>
<p><strong>NOTE 3</strong>: To limit your webapp request size (this is set automatically when deploying service as jar) one needs to configure the container manually. For example, when using <a href="http://tomcat.apache.org/tomcat-8.0-doc/config/http.html">Tomcat 7</a> or <a href="http://tomcat.apache.org/tomcat-8.0-doc/config/http.html">Tomcat 8</a> -
the http connector parameter <code>maxPostSize</code> should be configured with the desired limit.</p>
<p><strong>NOTE 4</strong>: The war file must be deployed to Tomcat ROOT.</p>
</blockquote>
<p>First we need to download Tomcat web servlet container as of the writing latest version available in version 7 branch is 7.0.77. We will download it with <code>wget</code></p>
<div class="codehilite"><pre><span></span>wget http://www-eu.apache.org/dist/tomcat/tomcat-7/v7.0.70/bin/apache-tomcat-7.0.70.tar.gz
</pre></div>


<p>Unpack it somewhere:</p>
<div class="codehilite"><pre><span></span>tar xf apache-tomcat-7.0.70.tar.gz
</pre></div>


<p>Now we should build the WAR file. We have created helper script with all the correct Maven parameters.</p>
<div class="codehilite"><pre><span></span>./war-build.sh
</pre></div>


<blockquote>
<p><strong>NOTE</strong> The script will skip running the integration tests when building WAR files</p>
</blockquote>
<p>Final steps would be copying built WAR file into Tomcat <code>webapps</code> directory and starting the servlet container.</p>
<div class="codehilite"><pre><span></span>cp siva-parent/siva-webapp/target/siva-webapp-2.0.2-SNAPSHOT.war apache-tomcat-7.0.70/webapps
./apache-tomcat-7.0.77/bin/catalina.sh run
</pre></div>


<blockquote>
<p><strong>IMPORTANT</strong> siva-webapp on startup creates <code>etc</code> directory where it copies the TSL validaiton certificates
<code>siva-keystore.jks</code>. Default location for this directory is application root or <code>$CATALINA_HOME</code>. To change
this default behavior you should set environment variable <code>DSS_DATA_FOLDER</code></p>
</blockquote>
<h3 id="how-to-set-war-deployed-siva-applicationproperties">How-to set WAR deployed SiVa <code>application.properties</code></h3>
<p>SiVa override properties can be set using <code>application.properties</code> file. The file can locate anywhare in the host system.
To make properties file accessible for SiVa you need to create or edit <code>setenv.sh</code> placed inside <code>bin</code> directory.</p>
<p>Contents of the <code>setenv.sh</code> file should look like:</p>
<div class="codehilite"><pre><span></span><span class="nb">export</span> <span class="nv">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Dspring.config.location=file:/path/to/application.properties&quot;</span>
</pre></div>


<h3 id="smoke-testing-your-deployed-system">Smoke testing your deployed system</h3>
<p><strong>Step 1</strong>. Install HTTPIE
<code>httpie</code> is more user friendly version of <code>curl</code> and we will use to verify that SiVa was installed
and started correctly on our server.</p>
<p>If you have Python and its package manager <code>pip</code> installed. Then You can issue below command:</p>
<div class="codehilite"><pre><span></span>pip install httpie
</pre></div>


<p><strong>Step 2</strong>. Download a sample JSON request file.</p>
<div class="codehilite"><pre><span></span>http --download https://raw.githubusercontent.com/open-eid/SiVa/develop/build-helpers/sample-requests/bdoc_pass.json
</pre></div>


<p><strong>Step 3</strong>. After successful download issue below command in same directory where you downloaded the file using
the command below.</p>
<div class="codehilite"><pre><span></span>http POST http://10.211.55.9:8080/validate &lt; bdoc_pass.json
</pre></div>


<p><strong>Step 4</strong>. Verify the output. The output of previous command should look like below screenshot. Look for <code>signatureCount</code> and
<code>validSignatureCount</code> they <strong>must</strong> be equal.</p>
<p><img alt="HTTPIE output validation" src="../../../img/siva/siva-output.png" /></p>
<h2 id="logging">Logging</h2>
<p>By default, logging works on the INFO level and logs are directed to the system console only. Logging functionality is handled by the SLF4J logging facade and on top of the Logback framework. As a result, logging can be configured via the standard Logback configuration file through Spring boot. Additional logging appenders can be added. Consult <a href="http://logback.qos.ch/documentation.html">logback documentation</a> for more details on log file structure.</p>
<p>For example, adding application.properties to classpath with the <strong>logging.config</strong> property</p>
<div class="codehilite"><pre><span></span>logging.config<span class="o">=</span>/path/to/logback.xml
</pre></div>


<h2 id="statistics">Statistics</h2>
<p>For every report validated, a statistical report is composed that collects the following data:</p>
<table>
<thead>
<tr>
<th>Data</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Validation duration</td>
<td>The time it takes to process an incoming request - measured in milliseconds</td>
</tr>
<tr>
<td>Container type</td>
<td>Container type ( text value that identifies the signature type of the incoming document: ASiC-E, XAdES, PAdES or ASiC-E (BatchSignature) )</td>
</tr>
<tr>
<td>Siva User ID</td>
<td>String (Text data that contains the SiVa user identifier for reports (from the HTTP x-authenticated-user header) or <code>N/A</code>)</td>
</tr>
<tr>
<td>Total signatures count</td>
<td>The value of the <code>signaturesCount</code> element in the validation report</td>
</tr>
<tr>
<td>Valid signatures count</td>
<td>The value of the <code>validSignaturesCount</code> element in the validation report</td>
</tr>
<tr>
<td>Signature validation indication(s)</td>
<td>Values of elements signatures/indication and signatures/subindication from the validation report. <code>indication[/subindication]</code></td>
</tr>
<tr>
<td>Signature country/countries</td>
<td>Country code extracted from the signer certs. The ISO-3166-1 alpha-2 country code that is associated with signature (the signing certificate). Or constant string "XX" if the country cannot be determined.</td>
</tr>
<tr>
<td>Signature format(s)</td>
<td>Values of element signatures/signatureFormat from the validation report. <signatureFormat></td>
</tr>
</tbody>
</table>
<p>There are two channels where this information is sent:</p>
<ol>
<li>
<p>Log feeds (at INFO level) which can be redirected to files or to a syslog feed.</p>
</li>
<li>
<p><strong>Google Analytics service</strong> (as GA events). Turned off by default. See <a href="../../../siva/v2/systemintegrators_guide/#configuration-parameters">Configuration parameters</a> for further details.</p>
</li>
</ol>
<p>The format and events are described in more detail in <a href="../../../pdf-files/SiVa_statistics.pdf">SiVa_statistics.pdf</a></p>
<h2 id="monitoring">Monitoring</h2>
<p>SiVa webapps provide an endpoint for external monitoring tools to periodically check the generic service health status.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that this endpoint is disabled by default.</p>
</div>
<p>The url for accessing JSON formatted health information with HTTP GET is <code>/monitoring/health</code> or <code>/monitoring/health.json</code>. See the <a href="../interfaces/#service-health-monitoring">Interfaces section</a> for response structure and details.</p>
<ul>
<li><strong>Enabling and disabling the monitoring endpoint</strong></li>
</ul>
<p>To enable the endpoint, use the following configuration parameter:</p>
<div class="codehilite"><pre><span></span>endpoints.health.enabled<span class="o">=</span><span class="nb">true</span>
</pre></div>


<ul>
<li><strong>Customizing external service health indicators</strong></li>
</ul>
<p>The endpoint is implemented as a customized Spring boot <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#production-ready-health">health endpoint</a>, which allows to add custom health indicators.</p>
<p>Demo webapp and Siva webapp also include additional information about the health of their dependent services.
These links to dependent web services have been preconfigured. For example, the Demo webapp is preset to check whether the Siva webapp is accessible from the following url (parameter <code>siva.service.serviceHost</code> value)/monitoring/health and the Siva webapp verifies that the X-road validation service webapp is accessible by checking the default url (configured by parameter <code>siva.proxy.xroadUrl</code> value)/monitoring/health url.</p>
<p>However, using the following parameters, these links can be overridden:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>endpoints.health.links[<code>index</code>].name</strong></td>
<td>A short link name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>endpoints.health.links[<code>index</code>].url</strong></td>
<td>URL to another monitoring endpoint that produces Spring boot <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#production-ready-health">health endpoint</a> compatible JSON object as a response to HTTP GET. <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>endpoints.health.links[<code>index</code>].timeout</strong></td>
<td>Connection timeout (in milliseconds)<ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="codehilite"><pre><span></span>endpoints.health.links<span class="o">[</span>0<span class="o">]</span>.name<span class="o">=</span>linkToXroad
endpoints.health.links<span class="o">[</span>0<span class="o">]</span>.url<span class="o">=</span>http://localhost:7777/monitoring/health
endpoints.health.links<span class="o">[</span>0<span class="o">]</span>.timeout<span class="o">=</span>1000
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The external link configuration must be explicitly set when the monitoring service on the target machine is configured to run on a different port as the target service itself(ie using the  <code>management.port</code> option in configuration) .</p>
</div>
<hr />
<h2 id="configuration-parameters">Configuration parameters</h2>
<p>All SiVa webapps have been designed to run with predetermined defaults after building and without additional configuration.
However, all the properties can be overridden on the service or embedded web server level, if necessary.</p>
<p>By default, the service loads it's global configuration from the application.yml file that is packaged inside the jar file.
Default configuration parameters can be overridden by providing custom application.yml in the <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-application-property-files">following locations</a>, or using command line parameters or by using other <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html">externalized configuration methods</a> methods.</p>
<p>For example, to configure the embedded Undertow web server inside a fat jar to run on different port (default is 8080), change the <strong>server.port</strong> following property:</p>
<div class="codehilite"><pre><span></span>server.port<span class="o">=</span>8080
</pre></div>


<p>Or to increase or modify the default http request limit, override the <strong>server.max-http-post-size</strong> property:</p>
<div class="codehilite"><pre><span></span>server.max-http-post-size: 13981016
</pre></div>


<p>See the reference list of all common <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html">application properties</a> provided by Spring boot</p>
<h3 id="siva-webapp-parameters">Siva webapp parameters</h3>
<ul>
<li>Updating TSL</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.tsl.loader.loadFromCache</strong></td>
<td>A boolean value that determines, whether the TSL disk cache is updated by downloading a new TSL in a predetermined interval<br/><br/>Note that the cache is by default stored in a system temporary folder (can be set with system property <code>java.io.tmpdir</code>) in a subdirectory named <code>dss_cache_tsl</code><ul><li>When set to <strong>false</strong> the cache is refreshed periodically by SiVa in a predetermined interval specified by <code>siva.tsl.loader.schedulerCron</code> using <code>siva.tsl.loader.url</code></li><li>When set to <strong>true</strong> the siva uses existing cache as it's TSL. No direct polling for updates are performed. </li><li>Default: <strong>false</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.tsl.loader.url</strong></td>
<td>A url value that points to the external TSL <ul><li>Default: <strong>https://ec.europa.eu/information_society/policy/esignature/trusted-list/tl-mp.xml</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.tsl.loader.code</strong></td>
<td>Sets the LOTL code in DSS <ul><li>Default: <strong>EU</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.tsl.loader.schedulerCron</strong></td>
<td>A string in a <a href="http://www.manpagez.com/man/5/crontab/">Crontab expression format</a> that defines the interval at which the TSL renewal process is started. The default is 03:00 every day (local time) <ul><li>Default: <strong>0 0 3 * * ?</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.keystore.type</strong></td>
<td>Keystore type. Keystore that contains public keys to verify the signed TSL <ul><li>Default: <strong>JKS</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.keystore.filename</strong></td>
<td>Keystore that contains public keys to verify the signed TSL <ul><li>Default: <strong>siva-keystore.jks</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.keystore.password</strong></td>
<td>Keystore password. Keystore that contains public keys to verify the signed TSL <ul><li>Default: <strong>siva-keystore-password</strong></li></ul></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the keystore file location can be overriden using environment variable <code>DSS_DATA_FOLDER</code>. By default the keystore file location, is expected to be on local filesystem in <code>etc</code> directory which is at the same level with the fat jar file (one is created, if no such directory exists).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>TSL is currently used only by PDF and BDOC validators</p>
</div>
<ul>
<li>Forward to custom X-road webapp instance</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.proxy.xroadUrl</strong></td>
<td>A URL where the X-Road validation requests are forwarded <ul><li>Default: <strong>http://localhost:8081</strong></li></ul></td>
</tr>
</tbody>
</table>
<ul>
<li>Collecting statistics with Google Analytics</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.statistics.google-analytics.enabled</strong></td>
<td>Enables/disables the service <ul><li>Default: <strong>false</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.statistics.google-analytics.url</strong></td>
<td>Statistics endpoint URL <ul><li>Default: <strong>http://www.google-analytics.com/batch</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.statistics.google-analytics.trackingId</strong></td>
<td>The Google Analytics tracking ID <ul><li>Default: <strong>UA-83206619-1</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.statistics.google-analytics.dataSourceName</strong></td>
<td>Descriptive text of the system <ul><li>Default: <strong>SiVa</strong></li></ul></td>
</tr>
</tbody>
</table>
<ul>
<li>BDOC validation parameters</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.bdoc.digidoc4JConfigurationFile</strong></td>
<td>Path to Digidoc4j configuration override <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
</tbody>
</table>
<p>Customizing BDOC validation policies</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.bdoc.signaturePolicy.defaultPolicy</strong></td>
<td>Selected default policy name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.bdoc.signaturePolicy.policies[<code>index</code>].name</strong></td>
<td>Policy name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.bdoc.signaturePolicy.policies[<code>index</code>].description</strong></td>
<td>Policy description <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.bdoc.signaturePolicy.policies[<code>index</code>].constraintPath</strong></td>
<td>Constraint XML file path for the policy. An absolute path or a reference to a resource on the classpath<ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.bdoc.signaturePolicy.policies[<code>index</code>].url</strong></td>
<td>Policy URL <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
</tbody>
</table>
<p>By default, the following configuration is used</p>
<div class="codehilite"><pre><span></span>siva.bdoc.signaturePolicy.policies[0].name=POLv1
siva.bdoc.signaturePolicy.policies[0].description=Policy for validating Electronic Signatures and Electronic Seals regardless of the legal type of the signature or seal (according to Regulation (EU) No 910/2014), i.e. the fact that the electronic signature or electronic seal is either Advanced electronic Signature (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a Qualified electronic Signature (QES) does not change the total validation result of the signature.
siva.bdoc.signaturePolicy.policies[0].url=http://open-eid.github.io/SiVa/siva/appendix/validation_policy/#POLv1
siva.bdoc.signaturePolicy.policies[0].constraintPath=bdoc_constraint_no_type.xml

siva.bdoc.signaturePolicy.policies[1].name=POLv2
siva.bdoc.signaturePolicy.policies[1].description=Policy for validating Qualified Electronic Signatures and Qualified Electronic Seals (according to Regulation (EU) No 910/2014). I.e. signatures that have been recognized as Advanced electronic Signatures (AdES) and AdES supported by a Qualified Certificate (AdES/QC) do not produce a positive validation result.
siva.bdoc.signaturePolicy.policies[1].url=http://open-eid.github.io/SiVa/siva/appendix/validation_policy/#POLv2
siva.bdoc.signaturePolicy.policies[1].constraintPath=bdoc_constraint_qes.xml

siva.bdoc.signaturePolicy.defaultPolicy=POLv1
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default policy configuration is lost when policy detail properties (name, description, url or constraintPath) are overridden or new custom policies added in custom configuration files (in this case, the existing default policies must be redefined in configuration files explicitly)</p>
</div>
<ul>
<li>PadES validation - customize validation policies</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.pdf.signaturePolicy.defaultPolicy</strong></td>
<td>Selected default policy name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.pdf.signaturePolicy.policies[<code>index</code>].name</strong></td>
<td>Policy name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.pdf.signaturePolicy.policies[<code>index</code>].description</strong></td>
<td>Policy description <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.pdf.signaturePolicy.policies[<code>index</code>].constraintPath</strong></td>
<td>Constraint XML file path for the policy. An absolute path or a reference to a resource on the classpath<ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.pdf.signaturePolicy.policies[<code>index</code>].url</strong></td>
<td>Policy URL <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
</tbody>
</table>
<p>By default, the following configuration is used</p>
<div class="codehilite"><pre><span></span>siva.pdf.signaturePolicy.policies[0].name=POLv1
siva.pdf.signaturePolicy.policies[0].description=Policy for validating Electronic Signatures and Electronic Seals regardless of the legal type of the signature or seal (according to Regulation (EU) No 910/2014), i.e. the fact that the electronic signature or electronic seal is either Advanced electronic Signature (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a Qualified electronic Signature (QES) does not change the total validation result of the signature.
siva.pdf.signaturePolicy.policies[0].url=http://open-eid.github.io/SiVa/siva/appendix/validation_policy/#POLv1
siva.pdf.signaturePolicy.policies[0].constraintPath=pdf_constraint_no_type.xml

siva.pdf.signaturePolicy.policies[1].name=POLv2
siva.pdf.signaturePolicy.policies[1].description=Policy for validating Qualified Electronic Signatures and Qualified Electronic Seals (according to Regulation (EU) No 910/2014). I.e. signatures that have been recognized as Advanced electronic Signatures (AdES) and AdES supported by a Qualified Certificate (AdES/QC) do not produce a positive validation result.
siva.pdf.signaturePolicy.policies[1].url=http://open-eid.github.io/SiVa/siva/appendix/validation_policy/#POLv2
siva.pdf.signaturePolicy.policies[1].constraintPath=pdf_constraint_qes.xml

siva.pdf.signaturePolicy.defaultPolicy=POLv1
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default policy configuration is lost when policy detail properties (name, description, url or constraintPath) are overridden or new custom policies added in custom configuration files (in this case, the existing default policies must be redefined in configuration files explicitly)</p>
</div>
<ul>
<li>DDOC validation</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.ddoc.jdigidocConfigurationFile</strong></td>
<td>Path to JDigidoc configuration file. Determines the Jdigidoc configuration parameters (see <a href="https://github.com/open-eid/jdigidoc/blob/master/doc/SK-JDD-PRG-GUIDE.pdf">JDigidoc manual</a> for details.<ul><li>Default: <strong>/siva-jdigidoc.cfg</strong></li></ul></td>
</tr>
</tbody>
</table>
<p>Customizing DDOC validation policies:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.ddoc.signaturePolicy.defaultPolicy</strong></td>
<td>Selected default policy name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.ddoc.signaturePolicy.policies[<code>index</code>].name</strong></td>
<td>Policy name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.ddoc.signaturePolicy.policies[<code>index</code>].description</strong></td>
<td>Policy description <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.ddoc.signaturePolicy.policies[<code>index</code>].constraintPath</strong></td>
<td>Constraint XML file path for the policy. An absolute path or a reference to a resource on the classpath<ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.ddoc.signaturePolicy.policies[<code>index</code>].url</strong></td>
<td>Policy URL <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
</tbody>
</table>
<p>By default, the following configuration is used</p>
<div class="codehilite"><pre><span></span>siva.ddoc.signaturePolicy.policies[0].name=POLv1
siva.ddoc.signaturePolicy.policies[0].description=Policy for validating Electronic Signatures and Electronic Seals regardless of the legal type of the signature or seal (according to Regulation (EU) No 910/2014), i.e. the fact that the electronic signature or electronic seal is either Advanced electronic Signature (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a Qualified electronic Signature (QES) does not change the total validation result of the signature.
siva.ddoc.signaturePolicy.policies[0].url=http://open-eid.github.io/SiVa/siva/appendix/validation_policy/#POLv1
siva.ddoc.signaturePolicy.policies[0].constraintPath=pdf_constraint_no_type.xml

siva.ddoc.signaturePolicy.policies[1].name=POLv2
siva.ddoc.signaturePolicy.policies[1].description=Policy for validating Qualified Electronic Signatures and Qualified Electronic Seals (according to Regulation (EU) No 910/2014). I.e. signatures that have been recognized as Advanced electronic Signatures (AdES) and AdES supported by a Qualified Certificate (AdES/QC) do not produce a positive validation result.
siva.ddoc.signaturePolicy.policies[1].url=http://open-eid.github.io/SiVa/siva/appendix/validation_policy/#POLv2
siva.ddoc.signaturePolicy.policies[1].constraintPath=pdf_constraint_qes.xml

siva.ddoc.signaturePolicy.defaultPolicy=POLv1
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default policy configuration is lost when policy detail properties (name, description, url or constraintPath) are overridden or new custom policies added in custom configuration files (in this case, the existing default policies must be redefined in configuration files explicitly)</p>
</div>
<h3 id="x-road-validation-webapp-parameters">X-road validation webapp parameters</h3>
<ul>
<li>X-road validation</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.xroad.validation.service.configurationDirectoryPath</strong></td>
<td>Directory that contains the certs of approved CA's, TSA's and list of members <ul><li>Default: <strong>/verificationconf</strong></li></ul></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.ddoc.signaturePolicy.defaultPolicy</strong></td>
<td>Selected default policy name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.ddoc.signaturePolicy.policies[<code>index</code>].name</strong></td>
<td>Policy name <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.ddoc.signaturePolicy.policies[<code>index</code>].description</strong></td>
<td>Policy description <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.ddoc.signaturePolicy.policies[<code>index</code>].constraintPath</strong></td>
<td>Constraint XML file path for the policy. An absolute path or a reference to a resource on the classpath<ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.ddoc.signaturePolicy.policies[<code>index</code>].url</strong></td>
<td>Policy URL <ul><li>Default: <strong>N/A</strong></li></ul></td>
</tr>
</tbody>
</table>
<p>By default, the following configuration is used</p>
<div class="codehilite"><pre><span></span>siva.ddoc.signaturePolicy.policies[0].name=POLv1
siva.ddoc.signaturePolicy.policies[0].description=Policy for validating Electronic Signatures and Electronic Seals regardless of the legal type of the signature or seal (according to Regulation (EU) No 910/2014), i.e. the fact that the electronic signature or electronic seal is either Advanced electronic Signature (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a Qualified electronic Signature (QES) does not change the total validation result of the signature.
siva.ddoc.signaturePolicy.policies[0].url=http://open-eid.github.io/SiVa/siva/appendix/validation_policy/#POLv1
siva.ddoc.signaturePolicy.policies[0].constraintPath=pdf_constraint_no_type.xml

siva.ddoc.signaturePolicy.defaultPolicy= POLv1
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default policy configuration is lost when policy detail properties (name, description, url or constraintPath) are overridden or new custom policies added in custom configuration files (in this case, the existing default policies must be redefined in configuration files explicitly)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, X-road validation currently supports only POLv1</p>
</div>
<h3 id="demo-webapp-parameters">Demo webapp parameters</h3>
<ul>
<li>Linking to SiVa webapp</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>siva.service.serviceHost</strong></td>
<td>An HTTP URL link to the Siva webapp <ul><li>Default: <strong>http://localhost:8080</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.service.jsonServicePath</strong></td>
<td>Service path in Siva webapp to access the REST/JSON API<ul><li>Default: <strong>/validate</strong></li></ul></td>
</tr>
<tr>
<td><strong>siva.service.soapServicePath</strong></td>
<td>Service path in Siva webapp to access the SOAP API <ul><li>Default: <strong>/soap/validationWebService/validateDocument</strong></li></ul></td>
</tr>
</tbody>
</table>
<h2 id="faq">FAQ</h2>
<hr />
<p>Q: SiVa webapp API-s require that you specify the document type? Is it possible to detect the container/file type automatically based on the provided file.</p>
<p>A: There is a demo webapp that provides a reference solution. See <code>ee.openeid.siva.sample.siva.ValidationRequestUtils</code> for reference.</p>
<hr />
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../deployment/" title="5.1 Deployment model">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                5.1 Deployment model
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../../qa_strategy/" title="6.1 QA Strategy">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                6.1 QA Strategy
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../../..';
      var repo_id  = 'open-eid/SiVa';
    </script>
    <script src="../../../assets/javascripts/application-997097ee0c.js"></script>
    
    
  </body>
</html>